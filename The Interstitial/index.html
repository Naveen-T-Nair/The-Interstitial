<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Interstitial | Your Blog</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- UPDATED: Added 'Oswald' font for the title -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Oswald:wght@700&display=swap" rel="stylesheet">
    <style>
        /* NEW BLACK & WHITE (MONOCHROME) LIGHT THEME */
        body { 
            font-family: 'Inter', sans-serif; 
            /* Light cool gray background (the 'desk') */
            background-color: #f3f4f6; /* Tailwind 'gray-100' */
            color: #333; 
        }
        /* NEW: Custom font class for the fallback title */
        .font-title {
            font-family: 'Oswald', sans-serif;
        }

        .post-content { 
            font-family: Georgia, 'Times New Roman', Times, serif; 
            font-size: 1.125rem; 
            line-height: 1.8; 
            color: #333; /* Dark text for posts */
        }
        .post-content h2 { 
            font-family: 'Inter', sans-serif; 
            font-size: 1.5rem; 
            font-weight: 700; 
            margin-top: 2rem; 
            margin-bottom: 1rem; 
            color: #111; /* Black headings */
        }
        .post-content p { margin-bottom: 1.5rem; }
        .post-content blockquote { 
            /* Simple gray accent color */
            border-left: 4px solid #6b7280; /* gray-500 */
            padding-left: 1rem; 
            margin-left: 0; 
            font-style: italic; 
            color: #555; 
        }
        
        /* NEW: Rule to set post title font */
        #post-title {
            font-family: Georgia, 'Times New Roman', Times, serif;
        }

        /* UPDATED NAV-BUTTON STYLES for MONOCHROME
          - Inactive buttons are light gray
          - Active button is solid black
        */
        .nav-button { 
            @apply px-4 py-2 rounded-md transition-colors font-medium bg-gray-200 text-gray-800 hover:bg-gray-300; 
        }
        .nav-button.active { 
            @apply bg-black text-white hover:bg-gray-800; 
        }
        .page { display: none; }
        .loader { 
            border: 4px solid #f3f3f3; /* gray-100 */
            /* Black accent color */
            border-top: 4px solid #111827; /* gray-900 */
            border-radius: 50%; 
            width: 40px; height: 40px; 
            animation: spin 1s linear infinite; 
            margin: 40px auto; 
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<!-- UPDATED BODY: Added h-screen and overflow-hidden, and the cool gray background -->
<body class="antiasliased h-screen overflow-hidden">

    <!-- 
      UPDATED DIV: 
      - This is the scrolling container
      - Set to 'bg-white' for a crisp "page" look
      - Added 'shadow-xl' to lift it off the gray background
    -->
    <div class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12 h-screen overflow-y-auto bg-white shadow-xl">
        
        <header class="text-center mb-10 md:mb-16">
            <!-- This will display your new logo -->
            <img src="logo.jpg" alt="The Interstitial Logo" 
                 class="mx-auto w-64 md:w-72 cursor-pointer" 
                 onclick="showPage('home')"
                 onerror="this.style.display='none'; document.getElementById('fallback-title').style.display='block'">
            
            <!-- Fallback text title if 'logo.jpg' fails to load -->
            <!-- UPDATED: Added the .font-title class -->
            <h1 id="fallback-title" class="text-4xl md:text-5xl font-bold tracking-tighter mb-2 text-black font-title" style="display:none;" onclick="showPage('home')">
                The Interstitial
            </h1>
        </header>

        <!-- UPDATED NAV: Added 'border-t' (top border), 'py-4' (vertical padding), and 'my-10' (vertical margin) -->
        <nav class="flex justify-center space-x-6 sm:space-x-8 my-10 md:my-16 border-b border-t border-gray-300 py-4">
            <button id="nav-home" class="nav-button active" onclick="showPage('home')">Home</button>
            <button id="nav-about" class="nav-button" onclick="showPage('about')">About</button>
        </nav>

        <main>
            <!-- This is the home page, which shows the list of posts -->
            <section id="page-home" class="page">
                <div id="post-list" class="space-y-12">
                    <!-- The hard-coded loader. JS will remove this when posts load. -->
                    <div class="loader"></div>
                </div>
            </section>

            <!-- This is the about page -->
            <section id="page-about" class="page">
                <div class="post-content prose prose-lg max-w-none">
                    <h1 class="text-3xl font-bold mb-6 text-black" style="font-family: 'Inter', sans-serif;">About Me</h1>
                    <!-- 
                      *** THIS LINE IS NOW FIXED ***
                      - Corrected "httpsa://" to "https://"
                      - Corrected the broken "onerror" attribute
                    -->
                    <!--<img src="https://placehold.co/800x400/333333/ffffff?text=A+photo+of+you!" alt="A placeholder image, you can replace this with your own." class="rounded-lg mb-6 w-full" onerror="this.src='https://placehold.co/800x400/333333/ffffff?text=Image+Not+Found'">-->
                    <p>Hello! My name is Naveen Thoniyil. I'm a PhD candidate based in Liverpool(originally from Kerala, India), specializing in Electrical Machines and Drives. By day, I'm an engineer and researcher who enjoys tinkering with complex systems and navigating technical challenges. By night, I transition into a philosopher, reader and writer, seeking to understand the world and the human side of life.</p>
                    <p>This blog is the direct result of that internal negotiation. It is a dedicated space for my "interstitial" thoughts, those quiet, significant connections that emerge from the very spaces between the things I study, the books I read, and the simple truth of human experience.</p>
                    <p>When I'm not deep in research or a good book, you can probably find me in the gym or enjoying a good game. I believe in the power of a strong mind and a strong body.</p>
                    <p>Welcome to my corner of the internet. I'm glad you're here.</p>
                </div>
            </section>

            <!-- This is the template for a single post page -->
            <section id="page-post" class="page">
                <!-- UPDATED: class changed to .nav-button -->
                <button class="nav-button mb-6" onclick="showPage('home')">&larr; Back to all posts</button>
                <article>
                    <!-- UPDATED: Removed inline font style, will be handled by CSS -->
                    <h1 id="post-title" class="text-3xl md:text-4xl font-bold mb-2 text-black"></h1>
                    <p id="post-date" class="text-gray-600 mb-6"></p>
                    <img id="post-image" src="" alt="" class="w-full h-auto rounded-lg mb-6" style="display:none;">
                    <div id="post-content" class="post-content prose prose-lg max-w-none">
                        <!-- The loader for when a post is fetching -->
                        <div class="loader"></div>
                    </div>
                </article>
            </section>
        </main>

        <!-- UPDATED FOOTER: Lighter border and text -->
        <footer class="text-center text-gray-500 border-t border-gray-300 pt-8 mt-16">
            <p>&copy; <span id="current-year"></span> Naveen Thoniyil. All rights reserved.</p>
        </footer>
    </div>

    <script>
        let allPosts = [];
        let currentPage = 'home';
        const pages = {
            home: document.getElementById('page-home'),
            about: document.getElementById('page-about'),
            post: document.getElementById('page-post')
        };
        const navLinks = {
            home: document.getElementById('nav-home'),
            about: document.getElementById('nav-about')
        };
        const postListContainer = document.getElementById('post-list');
        const postTitleEl = document.getElementById('post-title');
        const postDateEl = document.getElementById('post-date');
        const postImageEl = document.getElementById('post-image');
        const postContentEl = document.getElementById('post-content');

        function showPage(pageName) {
            currentPage = pageName;
            for (let key in pages) { pages[key].style.display = 'none'; }
            if (pages[pageName]) { pages[pageName].style.display = 'block'; }
            for (let key in navLinks) { 
                if (navLinks[key]) {
                    navLinks[key].classList.toggle('active', key === pageName); 
                }
            }
            
            // Only scroll the main content div to top, not the whole window
            const mainContent = document.querySelector('.overflow-y-auto');
            if (mainContent) mainContent.scrollTo(0, 0);
        }

        async function renderPostList() {
            postListContainer.innerHTML = ''; // This removes the hard-coded loader
            const sortedPosts = [...allPosts].sort((a, b) => b.id - a.id);
            sortedPosts.forEach(post => {
                const postElement = document.createElement('div');
                postElement.className = 'post-excerpt';
                // UPDATED: "Read more" links to plain black
                // UPDATED: h2 style changed to Georgia font
                postElement.innerHTML = `
                    <h2 class="text-2xl md:text-3xl font-bold mb-2" style="font-family: Georgia, 'Times New Roman', Times, serif;">
                        <a href="#" class="text-black hover:text-gray-700 transition-colors" onclick="event.preventDefault(); showPost(${post.id})">
                            ${post.title}
                        </a>
                    </h2>
                    <p class="text-gray-600 mb-4">${post.date}</p>
                    <p class="text-lg text-gray-800 mb-4">${post.excerpt}</p>
                    <a href="#" class="font-bold text-black hover:text-gray-700" onclick="event.preventDefault(); showPost(${post.id})">
                        Read more &rarr;
                    </a>
                `;
                postListContainer.appendChild(postElement);
            });
        }

        async function showPost(postId) {
            const post = allPosts.find(p => p.id === postId);
            if (!post) {
                console.error("Post not found!");
                return;
            }

            showPage('post');
            postTitleEl.textContent = post.title;
            postDateEl.textContent = post.date;

            // *** UPDATED THIS LOGIC ***
            // Now checks if post.image exists (is not an empty string)
            // It will now work for "posts/..." AND "http..."
            if (post.image && post.image.length > 0) {
                postImageEl.src = post.image;
                postImageEl.alt = post.title;
                postImageEl.style.display = 'block';
            } else {
                postImageEl.style.display = 'none';
            }

            postContentEl.innerHTML = '<div class="loader"></div>';

            try {
                const response = await fetch(`${post.file}?v=${new Date().getTime()}`);
                if (!response.ok) {
                    throw new Error(`Failed to fetch ${post.file}`);
                }
                const postHtml = await response.text();
                postContentEl.innerHTML = postHtml;
            } catch (error) {
                console.error("Error fetching post content:", error);
                postContentEl.innerHTML = `<p class="text-red-500">Error: Could not load post content.</p>`;
            }
        }

        async function init() {
            document.getElementById('current-year').textContent = new Date().getFullYear();
            
            try {
                const response = await fetch(`posts-index.json?v=${new Date().getTime()}`);
                if (!response.ok) {
                    throw new Error('Failed to fetch posts-index.json. Make sure the file exists.');
                }
                allPosts = await response.json();
                renderPostList(); // This removes the loader on success
            } catch (error)
            {
                console.error("Initialization Error:", error);
                postListContainer.innerHTML = `<p class="text-red-500 text-center">${error.message}</p>`; // This removes the loader on failure
            }
            
            showPage('home');
        }

        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>